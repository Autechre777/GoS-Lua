require('Inspired')

Menu = scriptConfig("Diana", "Moonwalker")
Menu.addParam("useQ", "Use Q in combo", SCRIPT_PARAM_ONOFF, true)
Menu.addParam("useW", "Use W in combo", SCRIPT_PARAM_ONOFF, true)
Menu.addParam("useE", "Use E in combo", SCRIPT_PARAM_ONOFF, true)
Menu.addParam("useR", "Use R in combo", SCRIPT_PARAM_ONOFF, true)
--Menu.addParam("ksR", "Use R to killsteal", SCRIPT_PARAM_ONOFF, true)
Menu.addParam("combo", "Combo", SCRIPT_PARAM_KEYDOWN, string.byte(" "))

Menu.addParam("escape", "Escape to mouse position", SCRIPT_PARAM_KEYDOWN, string.byte("a"))

OnLoop(function(myHero)

local myHeroPos = GetOrigin(myHero)
local target = GetCurrentTarget()
local mymouse = GetMousePos()
local QPred = GetPredictionForPlayer(GetOrigin(GetMyHero()), target, GetMoveSpeed(target),2000, 250, 830, 150, false, true)

-- Escape

	if Menu.escape then
		if CanUseSpell(myHero,_Q) == READY and CanUseSpell(myHero,_R) == READY then
			CastSkillShot(_Q,mymouse.x,mymouse.y,mymouse.z)
			delay(100)
			CastTargetSpell(_R,mymouse.x,mymouse.y,mymouse.z)

			elseif CanUseSpell(myHero,_R) == READY and CanUseSpell(myHero,_Q) == NOTAVAILABLE then
				CastTargetSpell(_R,mymouse.x,mymouse.y,mymouse.z)

		end
	end




		if Menu.combo then
-- RQ-Combo
	    	if CanUseSpell(myHero, _R) == READY and CanUseSpell(myHero, _Q) == READY and Menu.useR then

				if ValidTarget(target, GetCastRange(myHero, _R)) then
					CastTargetSpell(target,_R)
						if QPred.HitChance == 1 and CanUseSpell(myHero, _Q) == READY and Menu.useQ then
							CastSkillShot(_Q, QPred.PredPos.x, QPred.PredPos.y, QPred.PredPos.z)
						end
				end
			end
-- Basic Combo
-- Q
						if QPred.HitChance == 1 and CanUseSpell(myHero, _Q) == READY and Menu.useQ then
							CastSkillShot(_Q, QPred.PredPos.x, QPred.PredPos.y, QPred.PredPos.z)
						end
-- W
						if ValidTarget(target, 200) and Menu.useW then -- Fixed W - Working 2.0
								CastSpell(_W)
						end
-- E
						if ValidTarget(target, 240) and Menu.useE then -- Fixed E 2.0
									CastSpell(_E)
						end
		end
	end)
